this is the version 3 of the code